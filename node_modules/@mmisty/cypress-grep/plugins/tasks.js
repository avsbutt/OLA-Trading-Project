"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.taskWrite = void 0;
const fs_1 = require("fs");
const logs_1 = require("../common/logs");
/**
 * Write file with contents (file path predefined)
 * @param config - plugin config options
 * @param parentFolder - folder relatively to which test ran in prefilter mode
 * @param filteredSpecs - path to file (set in plugins)
 */
const taskWrite = (config, parentFolder, filteredSpecs) => ({
    writeTempFileWithSelectedTests: (contents) => {
        const result = Object.assign({ parentFolder }, contents);
        (0, fs_1.writeFileSync)(filteredSpecs, JSON.stringify(result, null, '  '));
        const cyan = '\x1b[36m';
        const end = '\x1b[0m';
        if (contents.tests.length > 0) {
            console.log(`${logs_1.pkgName} filtered:\n  ${cyan}◌${end} ${contents.tests
                .map(t => `${cyan}${`${t.filteredTitle}`.replace(/\/\//g, '/')}${end}`)
                .join(`\n  ${cyan}◌${end} `)}\n`);
        }
        console.log(`${logs_1.pkgName} filtered ${contents.tests.length} from total ${contents.total} tests by spec pattern: ${config.env['originalSpecPattern']}`);
        console.log(`${logs_1.pkgName} file with results written: '${filteredSpecs}'`);
        return null;
    },
});
exports.taskWrite = taskWrite;
